(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12210,        285]
NotebookOptionsPosition[     11220,        255]
NotebookOutlinePosition[     11569,        270]
CellTagsIndexPosition[     11526,        267]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"RiverToA", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RiverToB", "=", "50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RiverWidth", "=", "150"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VerticalAB", "=", "400"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SpeedGroundA", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SpeedGroundB", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SpeedStillRiver", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SpeedRiver", "=", 
   RowBox[{"-", "8"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7039435058347273`*^9, 3.70394351957465*^9}, {
   3.703943583715598*^9, 3.703943617579792*^9}, {3.7039436599882174`*^9, 
   3.703943664204134*^9}, {3.703943706228189*^9, 3.703943738462616*^9}, {
   3.703944292800538*^9, 3.7039442958083982`*^9}, {3.703944411480309*^9, 
   3.7039444291453953`*^9}, {3.7039453560476027`*^9, 3.703945384559104*^9}, {
   3.703945419775714*^9, 3.703945462431769*^9}, {3.703945499944149*^9, 
   3.703945522216406*^9}, {3.703947885695928*^9, 3.7039479135995903`*^9}, {
   3.703948440179545*^9, 3.703948449363311*^9}, 3.703948505555592*^9, {
   3.703948561276175*^9, 3.7039485613958673`*^9}, {3.703948974175047*^9, 
   3.703948989150651*^9}, {3.703949041030677*^9, 3.703949058789208*^9}, 
   3.703949143487598*^9, {3.703949181710989*^9, 3.7039492213199987`*^9}, {
   3.703949555402807*^9, 3.703949555610104*^9}, {3.70395077567319*^9, 
   3.703950778569639*^9}, {3.703952487412108*^9, 3.703952490651894*^9}, {
   3.703954938108038*^9, 3.703954939547641*^9}, {3.70395517075737*^9, 
   3.703955189829023*^9}, {3.7039566494948177`*^9, 3.703956650470689*^9}, {
   3.703956810863907*^9, 3.7039568119758453`*^9}, {3.703956853512273*^9, 
   3.703956929688504*^9}, 3.7039570082732067`*^9, {3.7039570984252977`*^9, 
   3.703957125825509*^9}, {3.703957212634594*^9, 3.703957230586279*^9}, {
   3.703957352518805*^9, 3.703957406611155*^9}, {3.703957442580728*^9, 
   3.7039574446753397`*^9}, {3.7039575121561937`*^9, 3.703957512651092*^9}, {
   3.703957596164707*^9, 3.703957600196479*^9}, {3.703960277005505*^9, 
   3.703960334285294*^9}, {3.703960410270955*^9, 3.703960435409693*^9}, {
   3.703960476198814*^9, 
   3.703960502110866*^9}},ExpressionUUID->"ae196069-13ba-465f-a977-\
e195ad5c48b9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Hypotenuse", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  SqrtBox[
   RowBox[{
    SuperscriptBox["x", "2"], "+", 
    SuperscriptBox["y", "2"]}]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DistanceAtoP", "[", "x_", "]"}], ":=", 
  RowBox[{"Hypotenuse", "[", 
   RowBox[{"RiverToA", ",", "x"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DistancePtoQa", "[", "x_", "]"}], ":=", 
  RowBox[{"Hypotenuse", "[", 
   RowBox[{"RiverWidth", ",", "x"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DistanceQatoQ", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"TimePtoQ", "[", "x", "]"}], "*", 
   "SpeedRiver"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DistancePtoQ", "[", "x_", "]"}], ":=", 
  RowBox[{"Hypotenuse", "[", 
   RowBox[{"RiverWidth", ",", 
    RowBox[{"x", "+", 
     RowBox[{"DistanceQatoQ", "[", "x", "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DistanceQtoB", "[", "x_", "]"}], ":=", 
  RowBox[{"Hypotenuse", "[", 
   RowBox[{"RiverToB", ",", "x"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimeAtoP", "[", "x_", "]"}], ":=", 
  FractionBox[
   RowBox[{"DistanceAtoP", "[", "x", "]"}], 
   "SpeedGroundA"]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimePtoQ", "[", "x_", "]"}], ":=", 
  FractionBox[
   RowBox[{"DistancePtoQa", "[", "x", "]"}], 
   "SpeedStillRiver"]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimeQtoB", "[", "x_", "]"}], ":=", 
  FractionBox[
   RowBox[{"DistanceQtoB", "[", "x", "]"}], "SpeedGroundB"]}]}], "Input",
 CellChangeTimes->{{3.703944431575552*^9, 3.703944437775065*^9}, {
   3.703944490967454*^9, 3.703944799123435*^9}, {3.703945054078395*^9, 
   3.7039450588054647`*^9}, {3.703945141390114*^9, 3.703945250518868*^9}, 
   3.703945295866097*^9, {3.703945620728936*^9, 3.703945669395253*^9}, {
   3.703945723010296*^9, 3.703945753815547*^9}, {3.703946012811985*^9, 
   3.703946100357185*^9}, {3.703946259887981*^9, 3.703946305454266*^9}, {
   3.703946376742386*^9, 3.703946428862421*^9}, {3.70394681654569*^9, 
   3.7039468171140842`*^9}, {3.703947133195861*^9, 3.703947143606662*^9}, {
   3.703947231660489*^9, 3.703947235764984*^9}, {3.7039472863255997`*^9, 
   3.703947303338738*^9}, 
   3.7039513341169443`*^9},ExpressionUUID->"93ca9a1f-9c58-460f-ab94-\
e323771d699f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NMinimize", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"TimeAtoP", "[", "x", "]"}], "+", 
      RowBox[{"TimePtoQ", "[", "y", "]"}], "+", 
      RowBox[{"TimeQtoB", "[", "z", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x", "+", "y", "+", "z", "+", 
       RowBox[{"DistanceQatoQ", "[", "y", "]"}]}], "==", "VerticalAB"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TimeAtoP", "[", "x", "]"}], "\[GreaterEqual]", "0"}], ",", 
     RowBox[{
      RowBox[{"TimePtoQ", "[", "y", "]"}], "\[GreaterEqual]", "0"}], ",", 
     RowBox[{
      RowBox[{"TimeQtoB", "[", "z", "]"}], "\[GreaterEqual]", "0"}]}], 
    "\[IndentingNewLine]", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
   RowBox[{"Method", "->", "\"\<SimulatedAnnealing\>\""}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7039464866906347`*^9, 3.703946637712214*^9}, {
  3.703946685913683*^9, 3.703946727553063*^9}, {3.703946769349814*^9, 
  3.703946780427135*^9}, {3.703946891755143*^9, 3.703946923718947*^9}, {
  3.703949451872905*^9, 3.703949479400548*^9}, {3.703955621833888*^9, 
  3.703955664397223*^9}, {3.703955752947123*^9, 3.703955756369516*^9}, {
  3.703955846481996*^9, 3.703955874194233*^9}, {3.703955936796067*^9, 
  3.70395593841894*^9}, {3.703956010317762*^9, 3.703956040778186*^9}, {
  3.703957152851202*^9, 
  3.703957178098976*^9}},ExpressionUUID->"37ab39a6-9967-42f3-964d-\
5d97218b6127"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"588.3643237765366`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", "356.1419214218994`"}], ",", 
     RowBox[{"y", "\[Rule]", "133.14015205988628`"}], ",", 
     RowBox[{"z", "\[Rule]", "178.1378616066264`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.703947318012718*^9, 3.703947892170251*^9, 3.7039483348609247`*^9, 
   3.7039484692252617`*^9, 3.703948512644603*^9, 3.7039485662027273`*^9, 
   3.703948982903069*^9, 3.703949072535676*^9, {3.703949129445035*^9, 
   3.7039492259578533`*^9}, {3.703949500018651*^9, 3.703949501917062*^9}, {
   3.703949557589808*^9, 3.7039495755222*^9}, 3.7039496434940147`*^9, 
   3.703950782700406*^9, 3.703952499555585*^9, 3.703953094683506*^9, {
   3.703953528518979*^9, 3.7039535373732643`*^9}, {3.703954943187689*^9, 
   3.703954951973413*^9}, {3.703955164304144*^9, 3.703955195367401*^9}, {
   3.7039556292973146`*^9, 3.703955664958898*^9}, {3.7039558545777597`*^9, 
   3.7039558828673277`*^9}, {3.7039560054249277`*^9, 3.703956014280284*^9}, 
   3.70395605515727*^9, 3.703956366525744*^9, 3.703956653527717*^9, 
   3.703956815749341*^9, {3.7039568585761747`*^9, 3.703956932352072*^9}, 
   3.703957012368266*^9, 3.703957129045477*^9, {3.703957222957795*^9, 
   3.703957233507017*^9}, {3.7039573782519207`*^9, 3.7039574101536703`*^9}, 
   3.703957603722612*^9, 3.703960291883256*^9, 3.7039603222823257`*^9, {
   3.703960413719264*^9, 3.7039604379032907`*^9}, {3.703960479975922*^9, 
   3.703960504385622*^9}},ExpressionUUID->"869ff036-0b2f-4223-b850-\
e48a5394b76a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NMinimize", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"DistanceAtoP", "[", "x", "]"}], "+", 
      RowBox[{"DistancePtoQa", "[", "y", "]"}], "+", 
      RowBox[{"DistanceQtoB", "[", "z", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x", "+", "y", "+", "z", "+", 
       RowBox[{"DistanceQatoQ", "[", "y", "]"}]}], "==", "VerticalAB"}]}], 
    "\[IndentingNewLine]", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
   RowBox[{"Method", "->", "\"\<SimulatedAnnealing\>\""}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.703947473744177*^9, 3.703947486824979*^9}, 
   3.703955027905411*^9, 
   3.7039560592940683`*^9},ExpressionUUID->"eae0477a-ba84-4142-b1fe-\
230a84bdc644"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"736.2980726001823`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", "367.1901247111066`"}], ",", 
     RowBox[{"y", "\[Rule]", "69.81854972110665`"}], ",", 
     RowBox[{"z", "\[Rule]", "183.59506235555344`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.703947488748682*^9, 3.7039478922810698`*^9, 3.703948334947403*^9, 
   3.7039484693510036`*^9, 3.703948512750551*^9, 3.703948566284926*^9, 
   3.703948983004829*^9, 3.703949072660884*^9, {3.703949129501521*^9, 
   3.7039492259820004`*^9}, {3.703949500044839*^9, 3.703949501942267*^9}, {
   3.703949557647831*^9, 3.703949575580418*^9}, 3.703949643550898*^9, 
   3.703950782760124*^9, 3.7039524996129208`*^9, 3.703953094742757*^9, {
   3.703953528580558*^9, 3.703953537431725*^9}, {3.70395494324434*^9, 
   3.7039549520300207`*^9}, 3.7039550299028*^9, {3.703955164359186*^9, 
   3.703955195391477*^9}, 3.703955882893548*^9, 3.70395601430585*^9, 
   3.703956060161976*^9, 3.7039563666275463`*^9, 3.70395665368122*^9, 
   3.703956815866843*^9, {3.7039568587497807`*^9, 3.703956932469557*^9}, 
   3.7039570125280933`*^9, {3.70395722308937*^9, 3.7039572336329412`*^9}, {
   3.703957378414464*^9, 3.703957410320313*^9}, 3.703957603802739*^9, 
   3.703960291962619*^9, {3.703960413884944*^9, 3.703960438012969*^9}, {
   3.703960480137285*^9, 
   3.7039605045373573`*^9}},ExpressionUUID->"aec19b88-7593-45cc-9459-\
31fa3d403f12"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"foo", "[", 
   RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"DistanceAtoP", "[", "x", "]"}], "+", 
   RowBox[{"DistancePtoQ", "[", "y", "]"}], "+", 
   RowBox[{"DistanceQtoB", "[", "z", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.703956551558556*^9, 3.70395656127078*^9}, 
   3.703956756080737*^9},ExpressionUUID->"6b6e29cf-ded2-4724-8542-\
d5b4963059b7"]
},
WindowSize->{1186, 863},
WindowMargins->{{643, Automatic}, {102, Automatic}},
FrontEndVersion->"11.1 for Linux x86 (64-bit) (2017\:5e744\:670821\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2380, 42, 195, "Input", "ExpressionUUID" -> \
"ae196069-13ba-465f-a977-e195ad5c48b9"],
Cell[2941, 64, 2335, 57, 297, "Input", "ExpressionUUID" -> \
"93ca9a1f-9c58-460f-ab94-e323771d699f"],
Cell[CellGroupData[{
Cell[5301, 125, 1566, 33, 207, "Input", "ExpressionUUID" -> \
"37ab39a6-9967-42f3-964d-5d97218b6127"],
Cell[6870, 160, 1577, 27, 34, "Output", "ExpressionUUID" -> \
"869ff036-0b2f-4223-b850-e48a5394b76a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8484, 192, 852, 20, 183, "Input", "ExpressionUUID" -> \
"eae0477a-ba84-4142-b1fe-230a84bdc644"],
Cell[9339, 214, 1444, 26, 34, "Output", "ExpressionUUID" -> \
"aec19b88-7593-45cc-9459-31fa3d403f12"]
}, Open  ]],
Cell[10798, 243, 418, 10, 34, "Input", "ExpressionUUID" -> \
"6b6e29cf-ded2-4724-8542-d5b4963059b7"]
}
]
*)

